<!-- pop-ups -->
<app-modal #portmodal>
    <div class="app-modal-header">
        Add a port
    </div>
    <div class="app-modal-body">
        <form #portForm="ngForm">
            <div class="form-group">
                <label>source device: </label>
                <select name="port-source" class="form-control" [(ngModel)]="port.source">
                    <option *ngFor="let d of devices" [value]="d.name">{{d.name}}</option>
                </select>
            </div>
            <div class="form-group">
                <label>port: </label>
                <select name="port-name" class="form-control" [(ngModel)]="port.name">
                    <option *ngFor="let p of ports" [value]="p.name">{{p.name}}</option>
                </select>
            </div>
            <div class="form-group">
                <label>destination device: </label>
                <select name="port-destination" class="form-control" [(ngModel)]="port.destination">
                    <option *ngFor="let d of devices" [value]="d.name">{{d.name}}</option>
                </select>
            </div>
        </form>
        <h6>post body (for this port)</h6>
        <pre>{{port | json}}</pre>
    </div>
    <div class="app-modal-footer">
        <button type="button" class="btn btn-default" (click)="portmodal.hide(); resetPort()">close</button>
        <button type="button" class="btn btn-primary" (click)="addPort(); portmodal.hide()">add</button>
    </div>
</app-modal>

<app-modal #commandmodal>
    <div class="app-modal-header">
        Add a command
    </div>
    <div class="app-modal-body">
        <form #commandForm="ngForm">
            <div class="form-group">
                <label>name: </label>
                <select name="command-name" class="form-control" [(ngModel)]="command.name">
                    <option *ngFor="let c of commands" [value]="c.name">{{c.name}}</option>
                </select>
            </div>
            <div class="form-group">
                <label>microservice: </label>
                <select name="command-microservice" class="form-control" [(ngModel)]="command.microservice">
                    <option *ngFor="let m of microservices" [value]="m.address">{{m.name}}</option>
                </select>
            </div>
            <div class="form-group">
                <label>endpoint: </label>
                <select name="command-endpoint" class="form-control" [(ngModel)]="command.endpoint.name">
                    <option *ngFor="let e of endpoints" [value]="e.name">{{e.name}}</option>
                </select>
            </div>
        </form>
        <h6>post body (for this command)</h6>
        <pre>{{command | json}}</pre>
    </div>
    <div class="app-modal-footer">
        <button type="button" class="btn btn-default" (click)="commandmodal.hide(); resetCommand()">close</button>
        <button type="button" class="btn btn-primary" (click)="addCommand(); commandmodal.hide()">add</button>
    </div>
</app-modal>

<app-modal #selectSingleOption>
    <div class="app-modal-body">
        <div class='selection-header centered-main-content'>
            <div class='selection-modal-title'> Select the {{selectionModalInfo.Title}}</div>
        </div>
        <div class='selection-body'>
            <input id="modalinputfilter" #modalinputfilter class='modal-input' [(ngModel)]="selectionModalInfo.FilterValue" (input)="filterModalOptions(modalinputfilter.value)" placeholder='Filter' autofocus />
            <div class='modal-selection-list'>
                <div *ngFor="let option of selectionModalInfo.filteredOptions">
                    <div class='modal-selection-option' (click)='selectionModalInfo.callback(toadd, option); selectSingleOption.hide();'>{{option.display}}</div>
                </div>
            </div>
        </div>
    </div>
</app-modal>
<app-modal #setDeviceRoles>
    <div class="app-modal-body">
        <div class='selection-header centered-main-content'>
            <div class='selection-modal-title'>Select the device roles</div>
        </div>
        <div class='selection-body'>
            <input id="modalinputfilter" #modalinputfilter class='modal-input' [(ngModel)]="selectionModalInfo.FilterValue" (input)="filterModalOptions(modalinputfilter.value)" placeholder='Filter' autofocus />
            <div class='modal-selection-list'>
                <div *ngFor="let option of selectionModalInfo.filteredOptions">
                    <div class='modal-selection-option'>{{option.display}}</div>
                </div>
            </div>
        </div>
    </div>
</app-modal>

<!-- end pop-ups -->

<div class="container">
    <div class="jumbotron">
        <h2 class="text-center">Add a Device to {{currBuilding}} {{currRoom}}</h2>
    </div>
</div>

<!-- form -->
<div class="card-background centered-main-content">
    <div class="card-container">
        <div class='card non-selectable medium' [class.flipped]="toadd.editingInfo">
            <div class='card-header'>Base Info</div>
            <div class='card-content'>
                <label class='card-label'>Name: </label>
                <div class=''>
                    <input class='card-input card-value' [(ngModel)]="toadd.name" /> </div>
            </div>
            <div class='card-content'>
                <label class='card-label'>Address: </label>
                <div class=''>
                    <input class='card-input card-value' [(ngModel)]="toadd.address" /> </div>
            </div>
            <div class='card-content'>
                <label class='card-label'>Type: </label>
                <div class=''>
                    <div class='card-input card-value clickable' (click)='editCurDeviceType()'>{{toadd.type}}</div>
                </div>
            </div>
            <div class='card-content'>
                <label class='card-label'>Class: </label>
                <div class=''>
                    <div class='card-input card-value clickable' (click)='editCurDeviceClass()'>{{toadd.class}} </div>
                </div>
            </div>
        </div>
        <div class='card non-selectable medium'>
            <div class='card-header'>
                <div>Classification</div>
            </div>
            <div class='card-content'>
                <label class='card-label'>Input: </label>
                <div class='card-value'>
                    <input type="checkbox" [checked]="toadd.input" (change)="toadd.input = !toadd.input" />
                </div>
            </div>
            <div class='card-content'>
                <label class='card-label'>Output: </label>
                <div class='card-value'>
                    <input type="checkbox" [checked]="toadd.output" (change)="toadd.output = !toadd.output" />
                </div>
            </div>
        </div>
        <div class='card non-selectable medium'>
            <div class='card-header'>Roles
                <div class='icon-container'>
                </div>
            </div>
            <div class='card-content'>
                <ul class='simple-list'>
                    <li *ngFor="let r of toadd.roles">{{r}}</li>
                    <li class="material-icons selectable add-button" (click)="editCurDeviceRoles()">add</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<form #deviceForm="ngForm" novalidate>
    <div class="form-group">
        <label>name </label>
        <input [(ngModel)]="toadd.name" class="form-control" name="name" placeholder="1106" />
    </div>
    <div class="form-group">
        <label>address </label>
        <input [(ngModel)]="toadd.address" class="form-control" name="address" placeholder="10.0.0.0" />
    </div>
    <div class="form-group">
        <label>input </label>
        <div class="radio" *ngFor="let b of bool">
            <label>
                <input type="radio" name="input" [(ngModel)]="toadd.input" [value]="b.value">{{b.display}}
            </label>
        </div>
    </div>
    <div class="form-group">
        <label>output </label>
        <div class="radio" *ngFor="let b of bool">
            <label>
                <input type="radio" name="output" [(ngModel)]="toadd.output" [value]="b.value">{{b.display}}
            </label>
        </div>
    </div>
    <div class="form-group">
        <label>type </label>
        <select class="form-control" name="types" [(ngModel)]="toadd.type">
            <option *ngFor="let dt of devicetypes" [value]="dt.name">{{dt.name}}</option>
        </select>
    </div>
    <div class="form-group">
        <label>roles </label>
        <select multiple name="roles" class="form-control" [(ngModel)]="toadd.roles">
            <option *ngFor="let r of deviceroledefinitions" [value]="r.name">{{r.name}}</option>
        </select>
    </div>
    <div class="form-group">
        <label>powerstates </label>
        <select multiple name="powerstates" class="form-control" [(ngModel)]="toadd.powerstates">
            <option *ngFor="let ps of powerstates" [value]="ps.name">{{ps.name}}</option>
        </select>
    </div>
    <div class="form-group">
        <label>ports </label>
        <button type="button" class="btn btn-default" (click)="portmodal.show()">add port</button>
    </div>
    <div class="form-group">
        <label>commands </label>
        <button type="button" class="btn btn-default" (click)="commandmodal.show()">add command</button>
    </div>
    <button type="submit" class="btn btn-primary" (click)="postData()">Post Data!</button>
    <button type="submit" class="btn btn-default" (click)="resetDevices()">Reset</button>
</form>
<!-- end form -->

<h4>post body</h4>
<pre>{{toadd | json}}</pre>

<!-- 
<h5>devices</h5>
<pre>{{devices | json}}</pre>
-->
